# Makefile template for MOM6
#
# Compiler flags are configured by autoconf's configure script.
#
# Source code dependencies are configured by mkmf and list_paths, specified in
# the `Makefile.mkmf` file.
#
# mkmf conventions are close, but not identical, to autoconf.  We attempt to
# map the autoconf variables to the mkmf variables.
#
# The following variables are used by Makefiles generated by mkmf.
#
#   CC      C compiler
#   CXX     C++ compiler
#   FC      Fortran compiler (f77 and f90)
#   LD      Linker
#   AR      Archiver
#
#   CPPDEFS     Preprocessor macros
#   CPPFLAGS    C preprocessing flags
#   CXXFLAGS    C++ preprocessing flags
#   FPPFLAGS    Fortran preprocessing flags
#
#   CFLAGS      C compiler flags
#   FFLAGS      Fortran compiler flags
#   LDFLAGS     Linker flags + libraries
#   ARFLAGS     Archiver flags
#
#   OTHERFLAGS      Additional flags for all languages (C, C++, Fortran)
#   OTHER_CFLAGS    Optional C flags
#   OTHER_CXXFLAGS  Optional C++ flags
#   OTHER_FFLAGS    Optional Fortran flags
#   TMPFILES        Placeholder for `make clean` deletion (as `make neat`).
#
#
#   NOTES:
#    - FPPFLAGS and FFLAGS always appear as a pair, and autoconf does not use
#      FPPFLAGS, so FPPFLAGS does not serve much purpose.
#
#    - mkmf's FFLAGS does not distinguish between autoconf's fixed-format
#      FFLAGS and free-format FCFLAGS.
#
#    - LDFLAGS does not distinguish between autoconf's LDFLAGS and LIBS.
#      It also places both after the executable rather than just LIBS.

FC = @FC@
LD = @FC@

CPPDEFS = @DEFS@
CPPFLAGS = @CPPFLAGS@
FFLAGS = @FCFLAGS@
LDFLAGS = @LDFLAGS@ @LIBS@

# Gather modulefiles
TMPFILES = $(wildcard *.mod)

include Makefile.mkmf


# Delete any files associated with configuration (including the Makefile).
.PHONY: distclean
distclean: clean
	# configure output
	rm -f config.log
	rm -f config.status
	rm -f Makefile
	# mkmf output
	rm -f path_names
	rm -f Makefile.mkmf


# This deletes all files generated by autoconf, including configure.
# It is more aggressive than automake's maintainer-clean.
# NOTE: Not a standard GNU target, this is for internal use only.
#   Don't be surprised if the name changes or if it disappears someday.
.PHONY: ac-clean
ac-clean: distclean
	rm -f @srcdir@/ac/aclocal.m4
	rm -rf @srcdir@/ac/autom4te.cache
	rm -f @srcdir@/ac/configure
